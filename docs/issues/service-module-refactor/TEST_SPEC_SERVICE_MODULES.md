# 服務層模組測試規格文檔

## 文檔資訊
- **版本**: 3.0.0
- **建立日期**: 2025-08-06
- **最後更新**: 2025-08-07
- **維護者**: 測試團隊
- **範圍**: 所有服務層 (Service Layer) 模組測試
- **來源**: 從 TEST_SPEC_HEALTH_KEYWORDS.md 分離並重構

## 變更歷史
| 版本 | 日期 | 變更內容 | 修改者 |
|------|------|----------|--------|
| 1.0.0 | 2025-08-06 | 從 TEST_SPEC_HEALTH_KEYWORDS.md 分離服務層測試 | 測試團隊 |
| 2.0.0 | 2025-08-07 | 重構並精簡測試從74個至48個，移除GPT-3.5相關測試 | 測試團隊 |
| 3.0.0 | 2025-08-07 | 完成helper測試合併，最終確定47個純SVC測試 | Claude Code |

## 1. 測試編號系統

### 1.1 編號格式
```
SVC-[模組]-[序號]-[類型]

範例: SVC-LD-001-UT
      SVC-PM-015-UT
```

### 1.2 服務層模組定義

| 代碼 | 模組 | 說明 | 原測試數 | 新測試數 | 精簡率 |
|------|------|------|----------|----------|--------|
| LD | Language Detection | 語言檢測服務 | 27 | 14 | -48% |
| PM | Prompt Manager | Prompt管理服務 | 29 | 15 | -48% |
| KW | Keyword Service | 關鍵字服務整合 | 10 | 10 | 0% |
| LLM | LLM Factory | LLM工廠服務 | 8 | 8 | 0% |
| **總計** | | | **74** | **47** | **-36%** |

### 1.3 測試類型
- **UT**: Unit Test (單元測試) - 服務層主要為單元測試
- **IT**: Integration Test (整合測試) - 服務間整合測試
- **PT**: Performance Test (效能測試) - 服務效能測試

## 2. 語言檢測服務 (SVC-LD)

### 2.1 測試概覽
- **總測試數**: 14個單元測試（精簡自27個）
- **測試檔案**: `test/unit/services/test_language_detection_service.py`
- **測試重點**: 核心語言檢測、拒絕機制、邊界條件
- **測試方法**: 
  - 使用 Mock 的 `SimplifiedLanguageDetector` 服務
  - 不調用真實 API，所有外部依賴使用 AsyncMock
  - 測試輸入資料從 fixtures 提供（確保 >200 字元）
  - 驗證返回的 `LanguageDetectionResult` 物件屬性

### 2.2 測試案例列表 (SVC-LD-001~014-UT)

#### 核心功能測試 (5個)

##### SVC-LD-001-UT: 純英文內容檢測
- **優先級**: P0
- **測試目標**: 驗證純英文內容正確識別為英文
- **測試資料**: 純英文職缺描述 (>200字元)
- **判斷標準**: 返回語言為 "en"，is_supported = True
- **合併的 Helper 測試**: 
  - `get_supported_languages()` - 驗證支援語言列表
  - `is_supported_language('en')` - 驗證英文是否支援

##### SVC-LD-002-UT: 純繁體中文檢測
- **優先級**: P0
- **測試目標**: 驗證純繁體中文內容正確識別
- **測試資料**: 純繁體中文職缺描述 (>200字元)
- **判斷標準**: 返回語言為 "zh-TW"，is_supported = True

##### SVC-LD-003-UT: 混合語言（繁中>20%）
- **優先級**: P0
- **測試目標**: 驗證混合語言閾值判斷邏輯
- **測試資料**: 包含25%繁中的混合文字 (>200字元)
- **判斷標準**: 返回語言為 "zh-TW"
- **合併的 Helper 測試**: 
  - `analyze_language_composition()` - 分析語言組成比例

##### SVC-LD-004-UT: 混合語言（繁中<20%）
- **優先級**: P0
- **測試目標**: 驗證混合語言閾值判斷邏輯
- **測試資料**: 包含15%繁中的混合文字 (>200字元)
- **判斷標準**: 返回語言為 "en"

##### SVC-LD-005-UT: 邊界條件（正好20%）
- **優先級**: P1
- **測試目標**: 驗證邊界條件處理
- **測試資料**: 恰好20%繁中的文字 (>200字元)
- **判斷標準**: 返回語言為 "zh-TW"（含20%）

#### 拒絕機制測試 (4個)

##### SVC-LD-006-UT: 拒絕簡體中文
- **優先級**: P0
- **測試目標**: 驗證簡體中文拒絕機制
- **測試資料**: 簡體中文文字 (>200字元)
- **判斷標準**: 拋出 UnsupportedLanguageError
- **HTTP 狀態碼**: 422 (UNPROCESSABLE_ENTITY)
- **錯誤碼**: "UNSUPPORTED_LANGUAGE"
- **檢測語言碼**: "zh-CN" 或 "zh-cn"
- **合併的 Helper 測試**: 
  - `is_supported_language('zh-CN')` - 驗證簡體中文不支援
  - `is_supported_language('zh-cn')` - 驗證小寫簡體中文不支援 

##### SVC-LD-007-UT: 拒絕日文
- **優先級**: P0
- **測試目標**: 驗證日文拒絕機制
- **測試資料**: 日文文字 (>200字元)
- **判斷標準**: 拋出 UnsupportedLanguageError
- **HTTP 狀態碼**: 422 (UNPROCESSABLE_ENTITY)
- **錯誤碼**: "UNSUPPORTED_LANGUAGE"
- **檢測語言碼**: "ja"
- **合併的 Helper 測試**: 
  - `is_supported_language('ja')` - 驗證日文不支援 

##### SVC-LD-008-UT: 拒絕韓文
- **優先級**: P0
- **測試目標**: 驗證韓文拒絕機制
- **測試資料**: 韓文文字 (>200字元)
- **判斷標準**: 拋出 UnsupportedLanguageError
- **HTTP 狀態碼**: 422 (UNPROCESSABLE_ENTITY)
- **錯誤碼**: "UNSUPPORTED_LANGUAGE"
- **檢測語言碼**: "ko"
- **合併的 Helper 測試**: 
  - `is_supported_language('ko')` - 驗證韓文不支援
  - `is_supported_language('es')` - 驗證西班牙文不支援 

##### SVC-LD-009-UT: 拒絕混合不支援語言
- **優先級**: P0
- **測試目標**: 驗證混合不支援語言的處理
- **測試資料**: 英文混合簡中/日文/韓文 (>200字元)
- **判斷標準**: 根據不支援語言比例決定拒絕或接受

#### 特殊處理測試 (5個)

##### SVC-LD-010-UT: 短文本處理
- **優先級**: P0
- **測試目標**: 驗證短文本的錯誤處理
- **測試資料**: 199字元的文字（MIN_TEXT_LENGTH=200）
- **判斷標準**: 拋出 LanguageDetectionError
- **錯誤訊息**: "Text too short (minimum 200 characters required)"
- **合併的 Helper 測試**: 
  - `validate_text_length()` - 驗證文字長度檢查功能
  - 測試 200, 500, 199, 100, 空字串等不同長度

##### SVC-LD-011-UT: HTML標籤過濾
- **優先級**: P1
- **測試目標**: 驗證HTML標籤不影響語言檢測
- **測試資料**: 包含HTML標籤的文字 (>200字元)
- **判斷標準**: 正確識別文字內容語言，忽略標籤

##### SVC-LD-012-UT: 大量文字處理
- **優先級**: P1
- **測試目標**: 驗證大量文字處理能力
- **測試資料**: 3000字的文字（繁中或英文）
- **判斷標準**: 
  - 3000字繁中文字返回語言為 "zh-TW"
  - 3000字英文文字返回語言為 "en"
  - 檢測時間 < 1000ms（大量文字可接受較長時間）

##### SVC-LD-013-UT: 技術專有名詞處理
- **優先級**: P1
- **測試目標**: 驗證專有名詞不影響語言檢測
- **測試資料**: 包含大量英文技術詞彙的中文文字 (>200字元)
- **判斷標準**: 正確識別主要語言

##### SVC-LD-014-UT: 效能基準測試
- **優先級**: P2
- **測試目標**: 建立效能基準
- **測試資料**: 標準測試集 (500字元)
- **判斷標準**: 檢測時間 < 100ms

## 3. Prompt管理服務 (SVC-PM)

### 3.1 測試概覽
- **總測試數**: 15個單元測試（精簡自29個）
- **測試檔案**: `test/unit/services/test_unified_prompt_service.py`
- **測試重點**: 版本管理、參數處理、配置載入
- **測試方法**:
  - Mock YAML 檔案載入（使用 tmp_path fixture）
  - Mock UnifiedPromptService 的各個方法
  - 驗證 prompt 版本選擇和參數替換
  - 測試快取機制和錯誤處理

### 3.2 測試案例列表 (SVC-PM-001~015-UT)

#### 語言版本管理測試 (5個)

##### SVC-PM-001-UT: 英文Prompt選擇
- **優先級**: P0
- **測試目標**: 驗證英文語言的Prompt選擇
- **測試資料**: 語言參數 "en"
- **判斷標準**: 返回英文版Prompt，版本包含 "-en"

##### SVC-PM-002-UT: 繁中Prompt選擇
- **優先級**: P0
- **測試目標**: 驗證繁中語言的Prompt選擇
- **測試資料**: 語言參數 "zh-TW"
- **判斷標準**: 返回繁中版Prompt，版本包含 "-zh-TW"

##### SVC-PM-003-UT: 預設回退機制
- **優先級**: P0
- **測試目標**: 驗證預設Prompt機制
- **測試資料**: 未定義的語言代碼 "fr"
- **判斷標準**: 返回預設英文Prompt

##### SVC-PM-004-UT: 版本追蹤功能
- **優先級**: P1
- **測試目標**: 驗證版本管理功能
- **測試資料**: 查詢Prompt版本
- **判斷標準**: 包含正確版本號 (如 v1.4.0)

##### SVC-PM-005-UT: Latest版本解析
- **優先級**: P1
- **測試目標**: 驗證 "latest" 版本解析
- **測試資料**: 版本參數 "latest"
- **判斷標準**: 返回最新版本的Prompt

#### 參數格式化測試 (5個)

##### SVC-PM-006-UT: 參數替換功能
- **優先級**: P0
- **測試目標**: 驗證參數替換功能
- **測試資料**: 包含 {job_description} 的模板
- **判斷標準**: 正確替換所有參數

##### SVC-PM-007-UT: 參數驗證
- **優先級**: P0
- **測試目標**: 驗證參數長度檢查 (>200字元)
- **測試資料**: 短文本參數 (<200字元)
- **判斷標準**: 拋出 ValidationError

##### SVC-PM-008-UT: Prompt格式化
- **優先級**: P1
- **測試目標**: 驗證格式化功能
- **測試資料**: 包含特殊格式的Prompt
- **判斷標準**: 正確格式化輸出

##### SVC-PM-009-UT: Token計數功能
- **優先級**: P2
- **測試目標**: 驗證Token計數功能
- **測試資料**: 標準長度Prompt
- **判斷標準**: 準確的Token數計算

##### SVC-PM-010-UT: Token限制檢查
- **優先級**: P1
- **測試目標**: 驗證Token限制
- **測試資料**: 超長Prompt (>4000 tokens)
- **判斷標準**: 發出警告或自動截斷

#### 配置處理測試 (5個)

##### SVC-PM-011-UT: YAML載入解析
- **優先級**: P0
- **測試目標**: 驗證YAML配置載入
- **測試資料**: 標準YAML配置檔
- **判斷標準**: 正確解析所有配置項

##### SVC-PM-012-UT: 快取機制
- **優先級**: P1
- **測試目標**: 驗證Prompt快取
- **測試資料**: 重複請求相同Prompt
- **判斷標準**: 第二次使用快取，載入時間 < 10ms

##### SVC-PM-013-UT: 檔案錯誤處理
- **優先級**: P0
- **測試目標**: 驗證錯誤處理
- **測試資料**: 模擬檔案不存在
- **判斷標準**: 優雅的錯誤處理，返回預設值

##### SVC-PM-014-UT: 上下文注入
- **優先級**: P2
- **測試目標**: 驗證上下文注入功能
- **測試資料**: 包含上下文參數
- **判斷標準**: 正確注入上下文資訊

##### SVC-PM-015-UT: LLM配置提取
- **優先級**: P0
- **測試目標**: 驗證LLM配置提取
- **測試資料**: 包含LLM配置的YAML
- **判斷標準**: 正確提取temperature、max_tokens等參數

## 4. 關鍵字服務整合 (SVC-KW)

### 4.1 測試概覽
- **總測試數**: 10個單元測試（保持原有）
- **測試檔案**: `test/unit/services/test_keyword_service_integration.py`
- **測試重點**: 服務協調、錯誤處理、資源管理
- **測試方法**:
  - Mock 語言檢測服務和 Prompt 管理服務
  - 模擬服務間的互動和錯誤情境
  - 使用 asyncio 測試併發處理
  - 驗證重試機制和超時處理

### 4.2 測試案例列表 (SVC-KW-001~010-UT)

#### 服務協調測試 (4個)

##### SVC-KW-001-UT: 語言檢測與Prompt整合
- **優先級**: P0
- **測試目標**: 驗證語言檢測服務與Prompt管理整合
- **測試資料**: 各種語言的職缺描述 (>200字元)
- **判斷標準**: 正確的語言對應正確的Prompt

##### SVC-KW-002-UT: 輸入預處理
- **優先級**: P0
- **測試目標**: 驗證輸入驗證 (>200字元)
- **測試資料**: 各種長度的輸入
- **判斷標準**: <200字元拋出錯誤，>=200字元正常處理

##### SVC-KW-003-UT: 輸出後處理
- **優先級**: P0
- **測試目標**: 驗證輸出格式化
- **測試資料**: 原始LLM輸出
- **判斷標準**: 標準化的JSON格式輸出

##### SVC-KW-004-UT: 服務降級機制
- **優先級**: P1
- **測試目標**: 驗證容錯機制
- **測試資料**: 模擬語言檢測服務失敗
- **判斷標準**: 使用預設英文Prompt繼續

#### 錯誤處理測試 (3個)
##### 錯誤處理模式分類：
- **暫時性錯誤 (Transient)**: 可重試，如網路超時、暫時性服務不可用
- **永久性錯誤 (Permanent)**: 不可重試，如資料格式錯誤、不支援的語言
- **資源錯誤 (Resource)**: 資源限制，如併發限制、資源池耗盡

##### SVC-KW-005-UT: 併發請求處理
- **優先級**: P1
- **測試目標**: 驗證併發安全
- **測試資料**: 同時10個請求
- **判斷標準**: 無競態條件，所有請求正確處理

##### SVC-KW-007-UT: 重試機制
- **優先級**: P1
- **測試目標**: 驗證重試邏輯
- **測試資料**: 模擬暫時性失敗
- **判斷標準**: 最多重試3次，成功恢復

##### SVC-KW-008-UT: 超時處理
- **優先級**: P1
- **測試目標**: 驗證超時機制
- **測試資料**: 模擬服務超時
- **判斷標準**: 100ms超時後優雅退出

#### 資源管理測試 (3個)

##### SVC-KW-006-UT: 資源池管理
- **優先級**: P2
- **測試目標**: 驗證資源管理
- **測試資料**: 資源分配和釋放
- **判斷標準**: 無資源洩漏，池大小正確

##### SVC-KW-009-UT: 錯誤聚合
- **優先級**: P2
- **測試目標**: 驗證錯誤收集
- **測試資料**: 多個服務錯誤
- **判斷標準**: 完整的錯誤報告，包含所有錯誤詳情

##### SVC-KW-010-UT: 健康檢查
- **優先級**: P1
- **測試目標**: 驗證健康檢查
- **測試資料**: 檢查所有依賴服務
- **判斷標準**: 準確的健康狀態報告

## 5. LLM Factory服務 (SVC-LLM)

### 5.1 測試概覽
- **總測試數**: 8個單元測試（保持原有）
- **測試檔案**: `test/unit/services/test_llm_factory_service.py`
- **測試重點**: 模型映射、動態功能、容錯機制
- **測試方法**:
  - Mock LLM Factory 的 DEPLOYMENT_MAP
  - Mock Azure OpenAI 客戶端
  - 測試模型名稱到部署名稱的映射
  - 模擬主模型失敗後的回退機制

### 5.2 測試案例列表 (SVC-LLM-001~008-UT)

#### 模型映射測試 (4個)

##### SVC-LLM-001-UT: GPT-4部署映射
- **優先級**: P0
- **測試目標**: 驗證GPT-4模型映射正確性
- **測試資料**: "gpt4o-2", "gpt-4.1", "gpt-4"
- **判斷標準**: 映射到正確的Azure部署名稱

##### SVC-LLM-002-UT: GPT-4.1 Mini部署映射
- **優先級**: P0
- **測試目標**: 驗證GPT-4.1 Mini模型映射
- **測試資料**: "gpt41-mini", "gpt-4.1-mini"
- **判斷標準**: 映射到 "gpt-41-mini-japaneast"

##### SVC-LLM-003-UT: 未知模型處理
- **優先級**: P0
- **測試目標**: 驗證錯誤處理
- **測試資料**: "gpt-5", "unknown-model"
- **判斷標準**: 拋出 ModelNotFoundError 或返回預設模型

##### SVC-LLM-004-UT: 區域選擇邏輯
- **優先級**: P1
- **測試目標**: 驗證Azure區域選擇
- **測試資料**: 不同區域配置
- **判斷標準**: 優先選擇 Japan East 區域

#### 動態功能測試 (4個)

##### SVC-LLM-005-UT: 容錯回退機制
- **優先級**: P0
- **測試目標**: 驗證主模型失敗時的回退
- **測試資料**: 模擬GPT-4失敗
- **判斷標準**: 自動切換到GPT-4.1 Mini

##### SVC-LLM-006-UT: 配置載入
- **優先級**: P0
- **測試目標**: 驗證配置載入
- **測試資料**: 環境變數和配置檔
- **判斷標準**: 正確解析所有配置

##### SVC-LLM-007-UT: 動態模型切換
- **優先級**: P2
- **測試目標**: 驗證運行時模型切換
- **測試資料**: 切換請求
- **判斷標準**: 無縫切換，不影響進行中的請求

##### SVC-LLM-008-UT: 模型能力查詢
- **優先級**: P2
- **測試目標**: 驗證模型能力查詢
- **測試資料**: 查詢各模型支援功能
- **判斷標準**: 返回正確的能力清單（如max_tokens、支援的功能）

## 6. 測試執行策略

### 6.1 測試執行腳本
```bash
# 新的統一執行腳本
./test/scripts/run_service_modules_tests.sh

# 預期輸出格式
╔══════════════════════════════════════════════════════════════════╗
║                    服務層模組測試執行報告                          ║
╠══════════════════════════════════════════════════════════════════╣
║ 執行時間: 2025-08-07 14:30:25                                     ║
║ 總耗時: 3.42 秒                                                   ║
╚══════════════════════════════════════════════════════════════════╝

📊 測試分布與結果矩陣
═══════════════════════════════════════════════════════════════════
| 測試模組    | 單元測試      | 總計         | 狀態 | 成功率 |
|-------------|---------------|--------------|------|--------|
| 語言檢測    | 14 ✅(14/0)   | 14 ✅(14/0)  | ✅   | 100%   |
| Prompt管理  | 15 ✅(15/0)   | 15 ✅(15/0)  | ✅   | 100%   |
| 關鍵字服務  | 10 ✅(10/0)   | 10 ✅(10/0)  | ✅   | 100%   |
| LLM Factory | 8  ✅(8/0)    | 8  ✅(8/0)   | ✅   | 100%   |
|-------------|---------------|--------------|------|--------|
| **總計**    | 47 ✅(47/0)   | 47 ✅(47/0)  | ✅   | 100%   |
═══════════════════════════════════════════════════════════════════
```

### 6.2 Mock策略
- **100% Mock**: 所有測試使用Mock，無真實API調用
- **參考實作**: `test/integration/test_keyword_extraction_language.py`
- **Mock工具**: pytest fixtures + AsyncMock + patch

### 6.3 測試資料要求
⚠️ **關鍵要求**: 所有JD和Resume測試資料必須 > 200字元
- 正向測試: 使用 >200字元 的資料
- 負向測試: 明確測試 <200字元 的驗證錯誤

## 7. 測試統計

### 7.1 測試分布統計

| 模組 | 測試數量 | 優先級分佈 | 實作狀態 |
|------|----------|------------|----------|
| 語言檢測 (LD) | 14 | P0:9, P1:3, P2:2 | 待實作 |
| Prompt管理 (PM) | 15 | P0:7, P1:6, P2:2 | 待實作 |
| 關鍵字服務 (KW) | 10 | P0:3, P1:5, P2:2 | 待實作 |
| LLM Factory (LLM) | 8 | P0:5, P1:1, P2:2 | 待實作 |
| **總計** | **47** | P0:24, P1:15, P2:8 | 待實作 |

### 7.2 優先級分佈

| 優先級 | 數量 | 百分比 | 說明 |
|--------|------|--------|------|
| P0 | 24 | 51.1% | 核心功能，必須通過 |
| P1 | 15 | 31.9% | 重要功能，應該通過 |
| P2 | 8 | 17.0% | 次要功能，建議通過 |

### 7.3 測試覆蓋率目標

| 覆蓋率類型 | 目標 | 當前 | 狀態 |
|------------|------|------|------|
| 行覆蓋率 | 85% | 待測 | 🔄 |
| 分支覆蓋率 | 80% | 待測 | 🔄 |
| 函數覆蓋率 | 90% | 待測 | 🔄 |

## 8. 實施計劃

### 8.1 實施階段

| 階段 | 任務 | 預計工時 | 完成標準 |
|------|------|----------|----------|
| Phase 1 | 建立測試檔案結構和fixtures | 2小時 | 目錄結構完成，基礎fixtures就緒 |
| Phase 2 | 實作語言檢測服務測試 (14個) | 3小時 | 14個測試全部通過 |
| Phase 3 | 實作Prompt管理服務測試 (15個) | 3小時 | 15個測試全部通過 |
| Phase 4 | 實作關鍵字和LLM Factory測試 (18個) | 3小時 | 18個測試全部通過 |
| Phase 5 | 建立測試執行腳本和報告 | 1小時 | 視覺化報告正常顯示 |

### 8.2 成功標準
- ✅ 所有47個測試通過
- ✅ 測試資料符合 >200字元要求
- ✅ 無需真實API調用（100% Mock）
- ✅ 單一測試執行時間 < 100ms
- ✅ 總測試套件執行時間 < 5秒
- ✅ 測試覆蓋率 > 85%
- ✅ 通過 Ruff 檢查（無錯誤）

## 9. Helper 測試合併總結

### 9.1 合併概覽
- **原始測試總數**: 57 個 (47 SVC + 10 Helper)
- **合併後測試總數**: 47 個 (純 SVC 測試)
- **合併完成日期**: 2025-08-07
- **合併策略**: 完全整合到對應的 SVC 測試中

### 9.2 Helper 測試合併映射

#### 語言檢測服務 (4個 Helper 測試)
| Helper 測試 | 合併到 | 整合方式 |
|------------|--------|----------|
| `test_get_supported_languages` | SVC-LD-001 | 在測試開始時驗證支援語言列表 |
| `test_is_supported_language` | SVC-LD-006~009 | 在拒絕測試中驗證語言支援狀態 |
| `test_validate_text_length` | SVC-LD-010 | 在短文本測試中驗證長度檢查邏輯 |
| `test_analyze_language_composition` | SVC-LD-003 | 在混合語言測試中分析語言組成 |

#### Prompt 管理服務 (3個 Helper 測試)
| Helper 測試 | 合併到 | 整合方式 |
|------------|--------|----------|
| `test_prompt_version_comparison` | SVC-PM-005 | 合併到版本解析測試 |
| `test_language_code_normalization` | SVC-PM-001~003 | 分散到語言選擇測試 |
| `test_cache_key_generation` | SVC-PM-012 | 合併到快取機制測試 |

#### LLM Factory 服務 (3個 Helper 測試)
| Helper 測試 | 合併到 | 整合方式 |
|------------|--------|----------|
| `test_deployment_map_lookup` | SVC-LLM-001~002 | 合併到模型映射測試 |
| `test_model_alias_resolution` | SVC-LLM-003 | 合併到未知模型處理 |
| `test_config_validation` | SVC-LLM-006 | 合併到配置載入測試 |

#### 關鍵字服務 (0個 Helper 測試)
- 無額外的 helper 測試

### 9.3 合併後的優勢
1. **簡化測試結構**: 減少測試檔案複雜度
2. **統一編號系統**: 所有測試都使用 SVC 編號
3. **提高維護性**: 相關功能測試集中在一起
4. **保持覆蓋率**: 功能覆蓋率不變，程式碼更緊湊

### 9.4 驗證檢查清單
- [x] 所有 helper 測試功能已整合
- [x] 測試總數減少到 47 個
- [x] 每個 SVC 測試包含必要的 helper 驗證
- [x] 測試執行腳本已更新
- [x] 文檔已完整記錄合併細節

## 10. 維護指南

### 10.1 新增測試規範
1. 遵循 `SVC-[模組]-[序號]-UT` 編號格式
2. 確保測試資料符合長度要求
3. 使用統一的Mock策略
4. 更新本文檔的統計資料

### 10.2 相關文檔
- [SERVICE_MODULE_TEST_REFACTOR_PLAN.md](./SERVICE_MODULE_TEST_REFACTOR_PLAN.md) - 重構計劃
- [MOCK_STRATEGY_GUIDE.md](./MOCK_STRATEGY_GUIDE.md) - Mock策略指南
- [TEST_COVERAGE_MATRIX.md](./TEST_COVERAGE_MATRIX.md) - 覆蓋率矩陣
- [TEST_DATA_REQUIREMENTS.md](./TEST_DATA_REQUIREMENTS.md) - 測試資料要求
- [TEST_SUMMARY_REPORT_FORMAT.md](./TEST_SUMMARY_REPORT_FORMAT.md) - 報告格式
- [HELPER_TESTS_CONSOLIDATION_PLAN.md](./HELPER_TESTS_CONSOLIDATION_PLAN.md) - Helper測試合併計劃
- [HELPER_TESTS_MERGE_COMPLETION.md](./HELPER_TESTS_MERGE_COMPLETION.md) - Helper測試合併完成報告
- [TEST_FAILURE_ANALYSIS.md](./TEST_FAILURE_ANALYSIS.md) - 測試失敗分析報告

---

**文檔維護**:
- 版本控制：使用語意化版本號
- 更新頻率：每個Sprint結束時審查
- 負責團隊：測試團隊與開發團隊共同維護