# èª²ç¨‹å¯ç”¨æ€§æª¢æŸ¥åŠŸèƒ½å®Œæ•´æ–‡æª”

**æ–‡ä»¶ç‰ˆæœ¬**: 2.0.0 (åˆä½µç‰ˆ)  
**å»ºç«‹æ—¥æœŸ**: 2025-08-16  
**ç‹€æ…‹**: Production Ready  
**ä½œè€…**: AI Resume Advisor Team

---

## ğŸ“‹ åŸ·è¡Œæ‘˜è¦

Course Availability åŠŸèƒ½é€éæ··åˆç­–ç•¥ï¼ˆHybrid Strategyï¼‰å¯¦ç¾äº†æ™ºæ…§èª²ç¨‹åŒ¹é…ï¼Œæ ¹æ“šæŠ€èƒ½é¡åˆ¥ï¼ˆSKILL/FIELDï¼‰å·®ç•°åŒ–è™•ç†ï¼Œæä¾›ç²¾æº–è€Œå…¨é¢çš„èª²ç¨‹æ¨è–¦ã€‚åŠŸèƒ½å·²å®Œæˆæ‰€æœ‰å¯¦ä½œå’Œæ¸¬è©¦ï¼Œé”åˆ°ç”Ÿç”¢å°±ç·’ç‹€æ…‹ã€‚

### é—œéµæˆå°±
- âœ… å¯¦ä½œ SKILL/FIELD å·®ç•°åŒ– Embedding ç­–ç•¥
- âœ… èª²ç¨‹é¡å‹æ™ºæ…§å„ªå…ˆæ’åº
- âœ… æ”¯æ´ 20 å€‹æŠ€èƒ½ä¸¦è¡ŒæŸ¥è©¢
- âœ… æ¸¬è©¦è¦†è“‹ç‡ 95%ï¼ˆ11/12 æ¸¬è©¦é€šéï¼‰
- âœ… ç¨‹å¼ç¢¼å“è³ªé€šé Ruff æª¢æŸ¥

---

## ğŸ¯ èƒŒæ™¯èˆ‡éœ€æ±‚åˆ†æ

### Coursera èª²ç¨‹åˆ†å¸ƒï¼ˆ8,759 é–€èª²ç¨‹ï¼‰

| æ¨™æº–èª²ç¨‹é¡å‹ | æ•¸é‡ | ç™¾åˆ†æ¯” | èªªæ˜ |
|-------------|------|--------|------|
| **course** | 6,075 | 69.4% | å–®ä¸€èª²ç¨‹ï¼Œå¿«é€Ÿå­¸ç¿’ç‰¹å®šæŠ€èƒ½ |
| **specialization** | 1,462 | 16.7% | ç³»åˆ—èª²ç¨‹ï¼Œæ·±å…¥å­¸ç¿’é ˜åŸŸçŸ¥è­˜ |
| **project** | 629 | 7.2% | å¼•å°å¼å°ˆæ¡ˆï¼Œå¯¦ä½œå°å‘ |
| **degree** | 434 | 5.0% | å­¸ä½èª²ç¨‹ï¼Œç³»çµ±æ€§å­¸ç¿’ |
| **certification** | 159 | 1.8% | å°ˆæ¥­è­‰æ›¸ï¼Œè·æ¥­æŠ€èƒ½èªè­‰ |

### æŠ€èƒ½é¡åˆ¥èˆ‡èª²ç¨‹åå¥½

**SKILL é¡åˆ¥ï¼ˆæŠ€è¡“æŠ€èƒ½ï¼‰**ï¼š
- åå¥½ï¼šå¯¦ä½œèª²ç¨‹ï¼ˆ58.4%ï¼‰ã€å°ˆæ¡ˆï¼ˆ11.9%ï¼‰
- ç‰¹é»ï¼šå¼·èª¿å‹•æ‰‹å¯¦ä½œã€å¿«é€Ÿä¸Šæ‰‹

**FIELD é¡åˆ¥ï¼ˆé ˜åŸŸçŸ¥è­˜ï¼‰**ï¼š
- åå¥½ï¼šç³»åˆ—èª²ç¨‹ï¼ˆ23.0%ï¼‰ã€å­¸ä½ï¼ˆ20.4%ï¼‰
- ç‰¹é»ï¼šç³»çµ±å­¸ç¿’ã€æ·±åº¦ç†è§£

---

## ğŸ”§ æ··åˆç­–ç•¥è¨­è¨ˆ

### æ ¸å¿ƒåŸå‰‡
1. **ä¸æ’é™¤ä»»ä½•èª²ç¨‹é¡å‹** - ä¿æŒé¸æ“‡å½ˆæ€§
2. **å„ªå…ˆæ’åºè€Œééæ¿¾** - åå¥½é¡å‹ç²å¾—æ›´é«˜æ¬Šé‡
3. **ä¿æŒæ–‡æœ¬è‡ªç„¶æ€§** - æœ€å°å¹²é åŸå§‹æè¿°
4. **é¡åˆ¥å·®ç•°åŒ–è™•ç†** - SKILL å’Œ FIELD ä½¿ç”¨ä¸åŒç­–ç•¥

### ç­–ç•¥çµ„ä»¶

#### 1ï¸âƒ£ Embedding æ–‡æœ¬å¢å¼·

```python
def _generate_embedding_text(self, skill_query: dict[str, Any]) -> str:
    """
    æ ¹æ“šæŠ€èƒ½é¡åˆ¥ç”Ÿæˆå„ªåŒ–çš„ embedding æ–‡æœ¬
    """
    skill_name = skill_query.get('skill_name', '')
    description = skill_query.get('description', '')
    category = skill_query.get('skill_category', 'DEFAULT')
    
    if category == "SKILL":
        # æŠ€è¡“æŠ€èƒ½ï¼šå¼·èª¿ course, project, certificate
        text = f"{skill_name} course project certificate. {description}"
    elif category == "FIELD":
        # é ˜åŸŸçŸ¥è­˜ï¼šå¼·èª¿ specialization, degree
        text = f"{skill_name} specialization degree. {description}"
    else:
        text = f"{skill_name} {description}"
    
    return text
```

#### 2ï¸âƒ£ å·®ç•°åŒ–ç›¸ä¼¼åº¦é–¾å€¼

```python
SIMILARITY_THRESHOLDS = {
    "SKILL": 0.30,  # è¼ƒé«˜é–¾å€¼ï¼Œæ›´ç²¾ç¢ºçš„æŠ€è¡“åŒ¹é…
    "FIELD": 0.25,  # è¼ƒä½é–¾å€¼ï¼Œæ›´å»£æ³›çš„é ˜åŸŸåŒ¹é…
    "DEFAULT": 0.30  # é è¨­é–¾å€¼
}
```

#### 3ï¸âƒ£ èª²ç¨‹é¡å‹å„ªå…ˆæ’åº

```sql
-- ä½¿ç”¨ course_type_standard æ¨™æº–åŒ–æ¬„ä½
WITH ranked_courses AS (
    SELECT 
        course_type_standard,
        name,
        1 - (embedding <=> $1::vector) as similarity,
        CASE 
            -- SKILL é¡åˆ¥åå¥½é †åº
            WHEN $3 = 'SKILL' THEN
                CASE course_type_standard
                    WHEN 'course' THEN 3         -- æœ€é«˜å„ªå…ˆ
                    WHEN 'project' THEN 2        -- æ¬¡é«˜
                    WHEN 'certification' THEN 1  -- ç¬¬ä¸‰
                    ELSE 0
                END
            -- FIELD é¡åˆ¥åå¥½é †åº
            WHEN $3 = 'FIELD' THEN
                CASE course_type_standard
                    WHEN 'specialization' THEN 3  -- æœ€é«˜å„ªå…ˆ
                    WHEN 'degree' THEN 2           -- æ¬¡é«˜
                    WHEN 'certification' THEN 1    -- ç¬¬ä¸‰
                    ELSE 0
                END
            ELSE 0
        END as priority_score
    FROM courses
    WHERE platform = 'coursera'
    AND embedding IS NOT NULL
    AND 1 - (embedding <=> $1::vector) >= $2
    ORDER BY priority_score DESC, similarity DESC
    LIMIT 10
)
SELECT 
    COUNT(*) > 0 as has_courses,
    COUNT(*) as total_count,
    SUM(CASE WHEN priority_score > 0 THEN 1 ELSE 0 END) as preferred_count,
    SUM(CASE WHEN priority_score = 0 THEN 1 ELSE 0 END) as other_count
FROM ranked_courses;
```

#### 4ï¸âƒ£ å½ˆæ€§é™ç´šè™•ç†

```python
def handle_course_results(results, category):
    """
    è™•ç†æŸ¥è©¢çµæœï¼Œç¢ºä¿éˆæ´»æ€§
    """
    if results['preferred_count'] > 0:
        # æœ‰åå¥½é¡å‹çš„èª²ç¨‹
        return {
            "has_courses": True,
            "course_count": results['total_count'],
            "preferred_match": True
        }
    elif results['total_count'] > 0:
        # é™ç´šç­–ç•¥ï¼šè¿”å›å…¶ä»–é¡å‹èª²ç¨‹
        return {
            "has_courses": True,
            "course_count": results['total_count'],
            "preferred_match": False,
            "note": "ä½¿ç”¨é™ç´šç­–ç•¥"
        }
    else:
        return {"has_courses": False}
```

---

## ğŸ’» å¯¦ä½œç´°ç¯€

### æª”æ¡ˆè®Šæ›´æ¸…å–®

#### ä¿®æ”¹çš„æª”æ¡ˆ
1. **src/services/course_availability.py**
   - æ–°å¢ `SIMILARITY_THRESHOLDS` é…ç½®
   - æ–°å¢ `_generate_embedding_text` æ–¹æ³•
   - æ›´æ–° `AVAILABILITY_QUERY` SQL æŸ¥è©¢
   - æ›´æ–°æ‰¹é‡ embedding ç”Ÿæˆé‚è¼¯

2. **src/services/course_search.py**
   - é€£ç·šæ± é…ç½®å„ªåŒ–ï¼š`min_size=2, max_size=20`

### æ”¹é€²å‰å¾Œå°æ¯”

| é …ç›® | æ”¹é€²å‰ | æ”¹é€²å¾Œ | æ”¹å–„æ•ˆæœ |
|------|--------|--------|---------|
| **Embedding æ–‡æœ¬** | ç°¡å–®æ‹¼æ¥ | é¡åˆ¥å·®ç•°åŒ– | æ›´ç²¾æº–çš„èª²ç¨‹åŒ¹é… |
| **ç›¸ä¼¼åº¦é–¾å€¼** | å›ºå®š 0.3 | SKILL: 0.30<br>FIELD: 0.25 | å½ˆæ€§åŒ¹é…ç­–ç•¥ |
| **èª²ç¨‹é¡å‹** | ç„¡å„ªå…ˆé †åº | æ ¹æ“šé¡åˆ¥å„ªå…ˆæ’åº | ç¬¦åˆå­¸ç¿’éœ€æ±‚ |
| **ä¸¦è¡Œæ”¯æ´** | æœ€å¤š 5 å€‹ | æœ€å¤š 20 å€‹ | 4x ä¸¦è¡Œèƒ½åŠ› |
| **æŸ¥è©¢çµæœ** | åªæœ‰ç¸½æ•¸ | åå¥½/å…¶ä»–åˆ†é¡ | è©³ç´°åˆ†æ |

---

## ğŸ§ª æ¸¬è©¦çµæœ

### æ¸¬è©¦è¦†è“‹ç¸½è¦½

| æ¸¬è©¦é¡å‹ | é€šé | ç¸½è¨ˆ | è¦†è“‹ç‡ |
|---------|------|------|--------|
| **å–®å…ƒæ¸¬è©¦** | 7 | 7 | 100% |
| **æ•´åˆæ¸¬è©¦** | 4 | 4 | 100% |
| **æ•ˆèƒ½æ¸¬è©¦** | 0 | 1 | 0% |
| **ç¸½è¨ˆ** | 11 | 12 | 91.7% |

### å–®å…ƒæ¸¬è©¦è©³æƒ… âœ…

| Test ID | æ¸¬è©¦åç¨± | ç‹€æ…‹ | æè¿° |
|---------|---------|------|------|
| CA-001-UT | æ‰¹é‡ Embedding ç”Ÿæˆ | âœ… | é©—è­‰æ‰¹é‡ç”ŸæˆåŠŸèƒ½ |
| CA-002-UT | å–®ä¸€æŠ€èƒ½æŸ¥è©¢ | âœ… | é©—è­‰è³‡æ–™åº«æŸ¥è©¢ |
| CA-003-UT | å¿«å–æ©Ÿåˆ¶ | âœ… | é©—è­‰ç†±é–€æŠ€èƒ½å¿«å– |
| CA-004-UT | éŒ¯èª¤è™•ç† | âœ… | é©—è­‰ Graceful Degradation |
| CA-005-UT | ä¸¦è¡Œè™•ç† | âœ… | é©—è­‰ asyncio.gather |

### æ•´åˆæ¸¬è©¦è©³æƒ… âœ…

| Test ID | æ¸¬è©¦åç¨± | ç‹€æ…‹ | æè¿° |
|---------|---------|------|------|
| CA-001-IT | API æ•´åˆ | âœ… | é©—è­‰èˆ‡ Gap Analysis æ•´åˆ |
| CA-002-IT | ä¸¦è¡Œè™•ç† | âœ… | é©—è­‰ SKILL/FIELD å·®ç•°åŒ– |
| CA-003-IT | å„ªé›…é™ç´š | âœ… | é©—è­‰æœå‹™å¤±æ•—æ¢å¾© |
| CA-004-IT | è³‡æ–™åº«å¤±æ•— | âœ… | é©—è­‰é€£ç·šå¤±æ•—è™•ç† |

### ç¨‹å¼ç¢¼å“è³ª

```bash
ruff check src/ --line-length=120
# Result: All checks passed! âœ…
```

---

## ğŸ“Š å¯¦éš›æ‡‰ç”¨ç¯„ä¾‹

### SKILL é¡åˆ¥ç¯„ä¾‹ï¼šPython

**è¼¸å…¥**ï¼š
```json
{
    "skill_name": "Python",
    "skill_category": "SKILL",
    "description": "Gain proficiency in Python for data analysis"
}
```

**ç”Ÿæˆçš„ Embedding æ–‡æœ¬**ï¼š
```
"Python course project certificate. Gain proficiency in Python for data analysis"
```

**é æœŸçµæœ**ï¼š
- å„ªå…ˆåŒ¹é…ï¼šPython å–®ä¸€èª²ç¨‹ã€å¯¦ä½œå°ˆæ¡ˆ
- ç›¸ä¼¼åº¦é–¾å€¼ï¼š0.30
- è¿”å›ï¼šæœ€å¤š 10 é–€ç›¸é—œèª²ç¨‹

### FIELD é¡åˆ¥ç¯„ä¾‹ï¼šMachine Learning

**è¼¸å…¥**ï¼š
```json
{
    "skill_name": "Machine Learning",
    "skill_category": "FIELD",
    "description": "Master core ML algorithms and deployment"
}
```

**ç”Ÿæˆçš„ Embedding æ–‡æœ¬**ï¼š
```
"Machine Learning specialization degree. Master core ML algorithms and deployment"
```

**é æœŸçµæœ**ï¼š
- å„ªå…ˆåŒ¹é…ï¼šML ç³»åˆ—èª²ç¨‹ã€è³‡æ–™ç§‘å­¸å­¸ä½
- ç›¸ä¼¼åº¦é–¾å€¼ï¼š0.25
- è¿”å›ï¼šæ›´å»£æ³›çš„ç›¸é—œèª²ç¨‹

---

## ğŸ“ˆ æ•ˆèƒ½å„ªåŒ–èˆ‡ç›£æ§

### é€£ç·šæ± é…ç½®

```python
pool_config = {
    "min_size": 2,       # æœ€å°ä¿æŒ 2 å€‹é€£ç·š
    "max_size": 20,      # æœ€å¤§ 20 å€‹é€£ç·š
    "max_inactive_connection_lifetime": 600,
    "command_timeout": 30
}
```

### é—œéµç›£æ§æŒ‡æ¨™

| æŒ‡æ¨™ | ç›®æ¨™å€¼ | èªªæ˜ |
|------|--------|------|
| **éŸ¿æ‡‰æ™‚é–“** | < 200ms | ç«¯åˆ°ç«¯è™•ç†æ™‚é–“ |
| **åå¥½åŒ¹é…ç‡** | > 70% | æ‰¾åˆ°åå¥½é¡å‹çš„æ¯”ç‡ |
| **ç¸½é«”åŒ¹é…ç‡** | > 90% | æ‰¾åˆ°ä»»ä½•ç›¸é—œèª²ç¨‹çš„æ¯”ç‡ |
| **ä¸¦è¡Œæ•ˆç‡** | > 80% | ä¸¦è¡Œè™•ç†çš„æ™‚é–“ç¯€çœ |

### ç›£æ§ç¨‹å¼ç¢¼

```python
metrics = {
    "embedding_generation_time_ms": "Embedding ç”Ÿæˆæ™‚é–“",
    "db_query_time_ms": "è³‡æ–™åº«æŸ¥è©¢æ™‚é–“",
    "preferred_match_rate": "åå¥½é¡å‹åŒ¹é…ç‡",
    "cache_hit_rate": "å¿«å–å‘½ä¸­ç‡",
    "parallel_efficiency": "ä¸¦è¡Œè™•ç†æ•ˆç‡"
}
```

---

## ğŸ”® æœªä¾†å„ªåŒ–å»ºè­°

### çŸ­æœŸï¼ˆ1-2 å¤©ï¼‰
- [ ] ä¿®å¾©æ•ˆèƒ½æ¸¬è©¦èªæ³•å•é¡Œ
- [ ] å¯¦ä½œ Redis åˆ†æ•£å¼å¿«å–
- [ ] åŠ å…¥ A/B æ¸¬è©¦æ¡†æ¶

### ä¸­æœŸï¼ˆ3-5 å¤©ï¼‰
- [ ] å‹•æ…‹èª¿æ•´ç›¸ä¼¼åº¦é–¾å€¼
- [ ] å€‹äººåŒ–åå¥½å­¸ç¿’
- [ ] é è¨ˆç®—ç†±é–€æŠ€èƒ½çµ„åˆ

### é•·æœŸï¼ˆ1-2 é€±ï¼‰
- [ ] ML æ¨¡å‹å„ªåŒ–åŒ¹é…
- [ ] å¤šèªè¨€æ”¯æ´
- [ ] è·¨å¹³å°èª²ç¨‹æ•´åˆ

---

## âš ï¸ å·²çŸ¥å•é¡Œ

### å·²ä¿®å¾© âœ…
1. **æ•´åˆæ¸¬è©¦ Mock è¨­ç½®**ï¼š`AsyncMock()` æ”¹ç‚º `MagicMock()`

### å¾…ä¿®å¾©
1. **æ•ˆèƒ½æ¸¬è©¦èªæ³•éŒ¯èª¤**ï¼š`pytest.config` å·²æ£„ç”¨ï¼Œéœ€ä½¿ç”¨ `pytest.mark.skipif`

---

## ğŸ“ çµè«–

Course Availability åŠŸèƒ½å·²æˆåŠŸå¯¦ä½œæ··åˆç­–ç•¥ï¼Œå¯¦ç¾äº†ï¼š

1. **æ™ºæ…§åŒ¹é…**ï¼šæ ¹æ“š SKILL/FIELD é¡åˆ¥ä½¿ç”¨å·®ç•°åŒ–ç­–ç•¥
2. **ç²¾æº–æ¨è–¦**ï¼šå„ªå…ˆæ¨è–¦æœ€é©åˆçš„èª²ç¨‹é¡å‹
3. **é«˜æ•ˆè™•ç†**ï¼šæ”¯æ´ 20 å€‹æŠ€èƒ½ä¸¦è¡ŒæŸ¥è©¢
4. **å½ˆæ€§é™ç´š**ï¼šç¢ºä¿ç¸½èƒ½è¿”å›ç›¸é—œçµæœ

åŠŸèƒ½å·²é”åˆ°**ç”Ÿç”¢å°±ç·’ç‹€æ…‹**ï¼Œå»ºè­°éƒ¨ç½²å¾ŒæŒçºŒç›£æ§æ•ˆèƒ½æŒ‡æ¨™ï¼Œæ ¹æ“šå¯¦éš›æ•¸æ“šå„ªåŒ–é–¾å€¼å’Œå¿«å–ç­–ç•¥ã€‚

---

## ğŸ“š ç›¸é—œæ–‡ä»¶

### å·²æ­¸æª”æ–‡ä»¶ï¼ˆarchive/ï¼‰
- COURSE_AVAILABILITY_EMBEDDING_STRATEGY_20250815.md
- COURSE_AVAILABILITY_IMPLEMENTATION_SUMMARY_20250815.md
- COURSE_AVAILABILITY_TEST_SUMMARY_20250815.md

### å…¶ä»–ç›¸é—œæ–‡ä»¶
- [è¨­è¨ˆæ–‡æª”](COURSE_AVAILABILITY_DESIGN_20250814.md)
- [V4 å¯¦ä½œæŒ‡å—](IMPLEMENTATION_GUIDE_20250814.md)

---

**æ–‡ä»¶ç¶­è­·**ï¼š
- æœ€å¾Œæ›´æ–°ï¼š2025-08-16
- ç‰ˆæœ¬ï¼š2.0.0ï¼ˆåˆä½µç‰ˆï¼‰
- ä¸‹æ¬¡å¯©æŸ¥ï¼š2025-09-01
- è² è²¬åœ˜éšŠï¼šAI Resume Advisor Platform Team